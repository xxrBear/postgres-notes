# 安装

## 可执行文件安装

推荐使用官方安装包，前往 [官网下载页](https://www.postgres.org/download/) 下载对应系统的安装包

直接运行可执行安装文件逐步安装即可

## 命令行安装

<details>
  <summary>Windows</summary>

- 安装包管理工具

```powershell
# !!!必须先用管理员权限打开终端

# 设置执行策略
Set-ExecutionPolicy Bypass -Scope Process -Force

# 安装 Chocolatey
[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072; 
iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))

# 验证安装
choco -v
```

- 安装数据库
```powershell
# 安装 PostgreSQL
choco install postgresql

# 启动服务
net start postgresql-x64-17

# 切换到 psql
psql -U postgres
```
</details>

<details>
<summary>Debian/Ubuntu</summary>

```bash
# 安装依赖
sudo apt update
sudo apt install -y wget ca-certificates

# 导入仓库签名密钥
wget --quiet -O - https://www.postgresql.org/media/keys/ACCC4CF8.asc | sudo apt-key add -

# 添加 PostgreSQL 仓库
sudo sh -c 'echo "deb http://apt.postgresql.org/pub/repos/apt $(lsb_release -cs)-pgdg main" > /etc/apt/sources.list.d/pgdg.list'

# 更新并安装
sudo apt update
sudo apt install -y postgresql postgresql-contrib
```
</details>

<details>
<summary>CentOS/RHEL/Fedora</summary>

```bash
# 安装仓库 RPM
sudo yum install -y https://download.postgresql.org/pub/repos/yum/reporpms/EL-$(rpm -E %{rhel})-x86_64/pgdg-redhat-repo-latest.noarch.rpm

# 禁用默认 PostgreSQL 模块
sudo dnf -qy module disable postgresql

# 安装 PostgreSQL
sudo yum install -y postgresql13-server postgresql13
```
</details>


## 访问数据库

当你安装好了 PostgreSQL 你会有一个默认用户和数据库 `postgres`，让我们使用`psql` 工具来连接它。

> 如果你无法执行 psql 命令，可能是没有添加相应的执行路径，你可以自行 Google 或 ChatGPT

**连接数据库**

```shell
psql -U postgres -d postgres;
```
- `- U` 参数后面输入的是对应用户名
- `- d` 参数后输入的是指定数据库

如果你的密码设置正确，那你将获得类似下面的输出：

```shell
用户 postgres 的口令：

psql (16.9)
输入 "help" 来获取帮助信息.

postgres=#
```

这表明数据库的版本是`16.9`版本，当前连接的数据库是`postgres`，尝试以下命令：`select version();` 这是 PostgreSQL 查询版本的方法

## 创建数据库

```sql
PS D:\> createdb -U postgres mydb
口令:
```

正确输入口令，也就是密码，这将创建一个名为`mydb`的数据库

## 创建 schema
schema 是数据库中的命名空间，每个数据库都可以拥有多个 schema，每个数据库都有一个默认的 schema public

```sql
-- 创建一个 schema mypg
CREATE SCHEMA mypg;
```

如果一个数据库需要同一个表时可以使用 schema 做区分，例如不同的 user 表放在不同的 schema 下。又或者利用权限管理，为不同 schema 分配不同的用户权限，起到用户权限管理的作用。

## 创建表
PostgreSQL 的表就像 Excel 中的 sheet 一样，它拥有列和行。对于一个表来说，它的列总是唯一的，但是它的行可能不唯一，这是由于数据库设计的数学模型导致的。当读取数据时，它返回的行的顺序也是随机的，除非你显示的指定排序规则。

要想创建一个数据表，你需要至少指定表的名称、列的名称和数据类型，例如：
```sql
CREATE TABLE my_first_table (
    first_column text,
    second_column integer
);
```
表可以包含的列数量是有限制的。根据列类型，数量在250到1600之间。然而，定义一个拥有近乎这个数量列的表通常是有问题的。

[返回目录](/README.md)
